<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>腾讯大数据开发工程师笔试题</title>
      <link href="/2022/09/21/%E8%85%BE%E8%AE%AF%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%AC%94%E8%AF%95%E9%A2%98/"/>
      <url>/2022/09/21/%E8%85%BE%E8%AE%AF%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%AC%94%E8%AF%95%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="腾讯大数据开发工程师笔试题"><a href="#腾讯大数据开发工程师笔试题" class="headerlink" title="腾讯大数据开发工程师笔试题"></a>腾讯大数据开发工程师笔试题</h2><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922104306031.png" alt="image-20220922104306031"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922105827035.png" alt="image-20220922105827035"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922105845913.png" alt="image-20220922105845913"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922105856493.png" alt="image-20220922105856493"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110209816.png" alt="image-20220922110209816"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110159169.png" alt="image-20220922110159169"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110307137.png" alt="image-20220922110307137"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110252044.png" alt="image-20220922110252044"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110321648.png" alt="image-20220922110321648"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110336700.png" alt="image-20220922110336700"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110359456.png" alt="image-20220922110359456"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110416142.png" alt="image-20220922110416142"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110535367.png" alt="image-20220922110535367"></p><p><img src="https://cdn.jsdelivr.net/gh/Lyotoc/Picphoto@main/img/image-20220922110930539.png" alt="image-20220922110930539"></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
      
      
      
        <tags>
            
            <tag> 笔试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redis配置文件详解</title>
      <link href="/2022/09/18/Redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/09/18/Redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="Redis配置文件详解"><a href="#Redis配置文件详解" class="headerlink" title="Redis配置文件详解"></a>Redis配置文件详解</h1><h2 id="1-Redis文件目录"><a href="#1-Redis文件目录" class="headerlink" title="1.Redis文件目录"></a>1.Redis文件目录</h2><p>（1）全局搜索配置文件 redis.conf 所在目录，和Redis相关的参数配置都在此目录下设置。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@bigdata1 ~]# find / -name redis.conf</span><br></pre></td></tr></table></figure><p>（2）命令所在目录</p><p>在Redis安装目录下的bin目录，例如：&#x2F;opt&#x2F;redis-5.0.7&#x2F;bin</p><h2 id="2-Redis配置字段解析"><a href="#2-Redis配置字段解析" class="headerlink" title="2.Redis配置字段解析"></a>2.Redis配置字段解析</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br></pre></td><td class="code"><pre><span class="line">[root@bigdata1 config]# cat redis.conf </span><br><span class="line">  #是否在后台执行，yes：后台运行；no：不是后台运行</span><br><span class="line">  daemonize yes</span><br><span class="line">   </span><br><span class="line">  #是否开启保护模式，默认开启。要是配置里没有指定bind和密码。开启该参数后，redis只会本地进行访问，拒绝外部访问。</span><br><span class="line">  protected-mode yes</span><br><span class="line">   </span><br><span class="line">  #redis的进程文件</span><br><span class="line">  pidfile /var/run/redis/redis-server.pid</span><br><span class="line">   </span><br><span class="line">  #redis监听的端口号。</span><br><span class="line">  port 6379</span><br><span class="line">   </span><br><span class="line">  #此参数确定了TCP连接中已完成队列(完成三次握手之后)的长度， 当然此值必须不大于Linux系统定义的/proc/sys/net/core/somaxconn值，默认是511，而Linux的默认参数值是128。当系统并发量大并且客户端速度缓慢的时候，可以将这二个参数一起参考设定。该内核参数默认值一般是128，对于负载很大的服务程序来说大大的不够。一般会将它修改为2048或者更大。在/etc/sysctl.conf中添加:net.core.somaxconn = 2048，然后在终端中执行sysctl -p。</span><br><span class="line">  tcp-backlog 511</span><br><span class="line">   </span><br><span class="line">  #指定 redis 只接收来自于该 IP 地址的请求，如果不进行设置，那么将处理所有请求</span><br><span class="line">  #bind 127.0.0.1</span><br><span class="line">  bind 0.0.0.0</span><br><span class="line">   </span><br><span class="line">  #配置unix socket来让redis支持监听本地连接。</span><br><span class="line">  # unixsocket /var/run/redis/redis.sock</span><br><span class="line">   </span><br><span class="line">  #配置unix socket使用文件的权限</span><br><span class="line">  # unixsocketperm 700</span><br><span class="line">   </span><br><span class="line">  # 此参数为设置客户端空闲超过timeout，服务端会断开连接，为0则服务端不会主动断开连接，不能小于0。</span><br><span class="line">  timeout 0</span><br><span class="line">   </span><br><span class="line">  #tcp keepalive参数。如果设置不为0，就使用配置tcp的SO_KEEPALIVE值，使用keepalive有两个好处:检测挂掉的对端。降低中间设备出问题而导致网络看似连接却已经与对端端口的问题。在Linux内核中，设置了keepalive，redis会定时给对端发送ack。检测到对端关闭需要两倍的设置值。</span><br><span class="line">  tcp-keepalive 0</span><br><span class="line">   </span><br><span class="line">  #指定了服务端日志的级别。级别包括：debug（很多信息，方便开发、测试），verbose（许多有用的信息，但是没有debug级别信息多），notice（适当的日志级别，适合生产环境），warn（只有非常重要的信息）</span><br><span class="line">  loglevel notice</span><br><span class="line">   </span><br><span class="line">  #指定了记录日志的文件。空字符串的话，日志会打印到标准输出设备。后台运行的redis标准输出是/dev/null。</span><br><span class="line">  logfile /var/log/redis/redis-server.log</span><br><span class="line">   </span><br><span class="line">  #是否打开记录syslog功能</span><br><span class="line">  # syslog-enabled no</span><br><span class="line">   </span><br><span class="line">  #syslog的标识符。</span><br><span class="line">  # syslog-ident redis</span><br><span class="line">   </span><br><span class="line">  #日志的来源、设备</span><br><span class="line">  # syslog-facility local0</span><br><span class="line">   </span><br><span class="line">  #数据库的数量，默认使用的数据库是DB 0。可以通过SELECT命令选择一个db</span><br><span class="line">  databases 16</span><br><span class="line">   </span><br><span class="line">  # redis是基于内存的数据库，可以通过设置该值定期写入磁盘。</span><br><span class="line">  # 注释掉“save”这一行配置项就可以让保存数据库功能失效</span><br><span class="line">  # 900秒（15分钟）内至少1个key值改变（则进行数据库保存--持久化） </span><br><span class="line">  # 300秒（5分钟）内至少10个key值改变（则进行数据库保存--持久化） </span><br><span class="line">  # 60秒（1分钟）内至少10000个key值改变（则进行数据库保存--持久化）</span><br><span class="line">  save 900 1</span><br><span class="line">  save 300 10</span><br><span class="line">  save 60 10000</span><br><span class="line">   </span><br><span class="line">  #当RDB持久化出现错误后，是否依然进行继续进行工作，yes：不能进行工作，no：可以继续进行工作，可以通过info中的rdb_last_bgsave_status了解RDB持久化是否有错误</span><br><span class="line">  stop-writes-on-bgsave-error yes</span><br><span class="line">   </span><br><span class="line">  #使用压缩rdb文件，rdb文件压缩使用LZF压缩算法，yes：压缩，但是需要一些cpu的消耗。no：不压缩，需要更多的磁盘空间</span><br><span class="line">  rdbcompression yes</span><br><span class="line">   </span><br><span class="line">  #是否校验rdb文件。从rdb格式的第五个版本开始，在rdb文件的末尾会带上CRC64的校验和。这跟有利于文件的容错性，但是在保存rdb文件的时候，会有大概10%的性能损耗，所以如果你追求高性能，可以关闭该配置。</span><br><span class="line">  rdbchecksum yes</span><br><span class="line">   </span><br><span class="line">  #rdb文件的名称</span><br><span class="line">  dbfilename dump.rdb</span><br><span class="line">   </span><br><span class="line">  #数据目录，数据库的写入会在这个目录。rdb、aof文件也会写在这个目录</span><br><span class="line">  dir /var/lib/redis</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">  ############### 主从复制 ###############</span><br><span class="line">   </span><br><span class="line">  #复制选项，slave复制对应的master。</span><br><span class="line">  # slaveof &lt;masterip&gt; &lt;masterport&gt;</span><br><span class="line">   </span><br><span class="line">  #如果master设置了requirepass，那么slave要连上master，需要有master的密码才行。masterauth就是用来配置master的密码，这样可以在连上master后进行认证。</span><br><span class="line">  # masterauth &lt;master-password&gt;</span><br><span class="line">   </span><br><span class="line">  #当从库同主机失去连接或者复制正在进行，从机库有两种运行方式：1) 如果slave-serve-stale-data设置为yes(默认设置)，从库会继续响应客户端的请求。2) 如果slave-serve-stale-data设置为no，除去INFO和SLAVOF命令之外的任何请求都会返回一个错误”SYNC with master in progress”。</span><br><span class="line">  slave-serve-stale-data yes</span><br><span class="line">   </span><br><span class="line">  #作为从服务器，默认情况下是只读的（yes），可以修改成NO，用于写（不建议）。</span><br><span class="line">  slave-read-only yes</span><br><span class="line">   </span><br><span class="line">  #是否使用socket方式复制数据。目前redis复制提供两种方式，disk和socket。如果新的slave连上来或者重连的slave无法部分同步，就会执行全量同步，master会生成rdb文件。有2种方式：disk方式是master创建一个新的进程把rdb文件保存到磁盘，再把磁盘上的rdb文件传递给slave。socket是master创建一个新的进程，直接把rdb文件以socket的方式发给slave。disk方式的时候，当一个rdb保存的过程中，多个slave都能共享这个rdb文件。socket的方式就的一个个slave顺序复制。在磁盘速度缓慢，网速快的情况下推荐用socket方式。</span><br><span class="line">  repl-diskless-sync no</span><br><span class="line">   </span><br><span class="line">  #diskless复制的延迟时间，防止设置为0。一旦复制开始，节点不会再接收新slave的复制请求直到下一个rdb传输。所以最好等待一段时间，等更多的slave连上来。</span><br><span class="line">  repl-diskless-sync-delay 5</span><br><span class="line">   </span><br><span class="line">  #slave根据指定的时间间隔向服务器发送ping请求。时间间隔可以通过 repl_ping_slave_period 来设置，默认10秒。</span><br><span class="line">  # repl-ping-slave-period 10</span><br><span class="line">   </span><br><span class="line">  #复制连接超时时间。master和slave都有超时时间的设置。master检测到slave上次发送的时间超过repl-timeout，即认为slave离线，清除该slave信息。slave检测到上次和master交互的时间超过repl-timeout，则认为master离线。需要注意的是repl-timeout需要设置一个比repl-ping-slave-period更大的值，不然会经常检测到超时。</span><br><span class="line">  # repl-timeout 60</span><br><span class="line">  </span><br><span class="line"> #是否禁止复制tcp链接的tcp nodelay参数，可传递yes或者no。默认是no，即使用tcp nodelay。如果master设置了yes来禁止tcp nodelay设置，在把数据复制给slave的时候，会减少包的数量和更小的网络带宽。但是这也可能带来数据的延迟。默认我们推荐更小的延迟，但是在数据量传输很大的场景下，建议选择yes。</span><br><span class="line"> repl-disable-tcp-nodelay no</span><br><span class="line">  </span><br><span class="line"> #复制缓冲区大小，这是一个环形复制缓冲区，用来保存最新复制的命令。这样在slave离线的时候，不需要完全复制master的数据，如果可以执行部分同步，只需要把缓冲区的部分数据复制给slave，就能恢复正常复制状态。缓冲区的大小越大，slave离线的时间可以更长，复制缓冲区只有在有slave连接的时候才分配内存。没有slave的一段时间，内存会被释放出来，默认1m。</span><br><span class="line"> # repl-backlog-size 5mb</span><br><span class="line">  </span><br><span class="line"> #master没有slave一段时间会释放复制缓冲区的内存，repl-backlog-ttl用来设置该时间长度。单位为秒。</span><br><span class="line"> # repl-backlog-ttl 3600</span><br><span class="line">  </span><br><span class="line"> #当master不可用，Sentinel会根据slave的优先级选举一个master。最低的优先级的slave，当选master。而配置成0，永远不会被选举。</span><br><span class="line"> slave-priority 100</span><br><span class="line">  </span><br><span class="line"> #redis提供了可以让master停止写入的方式，如果配置了min-slaves-to-write，健康的slave的个数小于N，mater就禁止写入。master最少得有多少个健康的slave存活才能执行写命令。这个配置虽然不能保证N个slave都一定能接收到master的写操作，但是能避免没有足够健康的slave的时候，master不能写入来避免数据丢失。设置为0是关闭该功能。</span><br><span class="line"> # min-slaves-to-write 3</span><br><span class="line">  </span><br><span class="line"> #延迟小于min-slaves-max-lag秒的slave才认为是健康的slave。</span><br><span class="line"> # min-slaves-max-lag 10</span><br><span class="line">  </span><br><span class="line"> # 设置1或另一个设置为0禁用这个特性。</span><br><span class="line"> # Setting one or the other to 0 disables the feature.</span><br><span class="line"> # By default min-slaves-to-write is set to 0 (feature disabled) and</span><br><span class="line"> # min-slaves-max-lag is set to 10.</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"> ############### 安全相关 ###############</span><br><span class="line">  </span><br><span class="line"> #requirepass配置可以让用户使用AUTH命令来认证密码，才能使用其他命令。这让redis可以使用在不受信任的网络中。为了保持向后的兼容性，可以注释该命令，因为大部分用户也不需要认证。使用requirepass的时候需要注意，因为redis太快了，每秒可以认证15w次密码，简单的密码很容易被攻破，所以最好使用一个更复杂的密码。注意只有密码没有用户名。</span><br><span class="line"> # requirepass foobared</span><br><span class="line">  </span><br><span class="line"> #把危险的命令给修改成其他名称。比如CONFIG命令可以重命名为一个很难被猜到的命令，这样用户不能使用，而内部工具还能接着使用。</span><br><span class="line"> # rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span><br><span class="line">  </span><br><span class="line"> #设置成一个空的值，可以禁止一个命令</span><br><span class="line"> # rename-command CONFIG &quot;&quot;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"> ############### 进程限制相关 ###############</span><br><span class="line">  </span><br><span class="line"> # 设置能连上redis的最大客户端连接数量。默认是10000个客户端连接。由于redis不区分连接是客户端连接还是内部打开文件或者和slave连接等，所以maxclients最小建议设置到32。如果超过了maxclients，redis会给新的连接发送’max number of clients reached’，并关闭连接。</span><br><span class="line"> # maxclients 10000</span><br><span class="line">  </span><br><span class="line"> #redis配置的最大内存容量。当内存满了，需要配合maxmemory-policy策略进行处理。注意slave的输出缓冲区是不计算在maxmemory内的。所以为了防止主机内存使用完，建议设置的maxmemory需要更小一些。</span><br><span class="line"> # maxmemory &lt;bytes&gt;</span><br><span class="line">  </span><br><span class="line"> #内存容量超过maxmemory后的处理策略。</span><br><span class="line"> #volatile-lru：利用LRU算法移除设置过过期时间的key。</span><br><span class="line"> #volatile-random：随机移除设置过过期时间的key。</span><br><span class="line"> #volatile-ttl：移除即将过期的key，根据最近过期时间来删除（辅以TTL）</span><br><span class="line"> #allkeys-lru：利用LRU算法移除任何key。</span><br><span class="line"> #allkeys-random：随机移除任何key。</span><br><span class="line"> #noeviction：不移除任何key，只是返回一个写错误。</span><br><span class="line"> #上面的这些驱逐策略，如果redis没有合适的key驱逐，对于写命令，还是会返回错误。redis将不再接收写请求，只接收get请求。写命令包括：set setnx setex append incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby getset mset msetnx exec sort。</span><br><span class="line"> # maxmemory-policy noeviction</span><br><span class="line">  </span><br><span class="line"> #lru检测的样本数。使用lru或者ttl淘汰算法，从需要淘汰的列表中随机选择sample个key，选出闲置时间最长的key移除。</span><br><span class="line"> # maxmemory-samples 5</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"> ############### APPEND ONLY 持久化方式 ###############</span><br><span class="line">  </span><br><span class="line"> #默认redis使用的是rdb方式持久化，这种方式在许多应用中已经足够用了。但是redis如果中途宕机，会导致可能有几分钟的数据丢失，根据save来策略进行持久化，Append Only File是另一种持久化方式，可以提供更好的持久化特性。Redis会把每次写入的数据在接收后都写入 appendonly.aof 文件，每次启动时Redis都会先把这个文件的数据读入内存里，先忽略RDB文件。</span><br><span class="line"> appendonly no</span><br><span class="line">  </span><br><span class="line"> #aof文件名</span><br><span class="line"> appendfilename &quot;appendonly.aof&quot;</span><br><span class="line">  </span><br><span class="line"> #aof持久化策略的配置</span><br><span class="line"> #no表示不执行fsync，由操作系统保证数据同步到磁盘，速度最快。</span><br><span class="line"> #always表示每次写入都执行fsync，以保证数据同步到磁盘。</span><br><span class="line"> #everysec表示每秒执行一次fsync，可能会导致丢失这1s数据。</span><br><span class="line"> appendfsync everysec</span><br><span class="line">  </span><br><span class="line"> # 在aof重写或者写入rdb文件的时候，会执行大量IO，此时对于everysec和always的aof模式来说，执行fsync会造成阻塞过长时间，no-appendfsync-on-rewrite字段设置为默认设置为no。如果对延迟要求很高的应用，这个字段可以设置为yes，否则还是设置为no，这样对持久化特性来说这是更安全的选择。设置为yes表示rewrite期间对新写操作不fsync,暂时存在内存中,等rewrite完成后再写入，默认为no，建议yes。Linux的默认fsync策略是30秒。可能丢失30秒数据。</span><br><span class="line"> no-appendfsync-on-rewrite no</span><br><span class="line">  </span><br><span class="line"> #aof自动重写配置。当目前aof文件大小超过上一次重写的aof文件大小的百分之多少进行重写，即当aof文件增长到一定大小的时候Redis能够调用bgrewriteaof对日志文件进行重写。当前AOF文件大小是上次日志重写得到AOF文件大小的二倍（设置为100）时，自动启动新的日志重写过程。</span><br><span class="line"> auto-aof-rewrite-percentage 100</span><br><span class="line"> #设置允许重写的最小aof文件大小，避免了达到约定百分比但尺寸仍然很小的情况还要重写</span><br><span class="line"> auto-aof-rewrite-min-size 64mb</span><br><span class="line">  </span><br><span class="line"> #aof文件可能在尾部是不完整的，当redis启动的时候，aof文件的数据被载入内存。重启可能发生在redis所在的主机操作系统宕机后，尤其在ext4文件系统没有加上data=ordered选项（redis宕机或者异常终止不会造成尾部不完整现象。）出现这种现象，可以选择让redis退出，或者导入尽可能多的数据。如果选择的是yes，当截断的aof文件被导入的时候，会自动发布一个log给客户端然后load。如果是no，用户必须手动redis-check-aof修复AOF文件才可以。</span><br><span class="line"> aof-load-t